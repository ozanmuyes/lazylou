/*
 * Lazylou version 1.0.0
 * Ozan Müyesseroğlu
 *
 * http://www.ozanmuyes.com
 * dialog@ozanmuyes.com
 *
 */
$.lazylouLoadImage=function(b){var a=function(d){var g=new Image();g.onload=e;g.onerror=f;g.onabort=f;g.src=b;function e(){c();d.resolve(g)}function f(){c();d.reject(g)}function c(){g.onload=null;g.onerror=null;g.onabort=null}};return $.Deferred(a).promise()};(function(d,g,i,c){var f="lazylou";var e=0;var l=[];var k=0;function m(t,u){var q=this;q.element=t;var s=d(t);q.metadata=s.data(f+"-options");q.options=d.extend({},d.fn[f].defaults,q.metadata,u);d.each(q.options,function(w,v){p_DataName=n(w);if(typeof(s.data(f+"-options-"+p_DataName))==="undefined"){return}q.options[w]=s.data(f+"-options-"+p_DataName)});s.attr("data-lazylou-id",e);q.options._id=e++;if(q.options.name!==null){if(typeof(l[q.options.name])==="undefined"){l[q.options.name]=new Array()}l[q.options.name][l[q.options.name].length]=q.options._id}q.options._cssSelector=a(t)+"[data-lazylou-id="+q.options._id+"]";q.options.spriteIndex=h(q);if(q.options.src===null&&q.options.name===null){console.log(f+".js | Error | ID="+q.options._cssSelector+" | Element has no src nor name to load an image.");return null}if(q.options.cleanUp){var r=s.data();var p="";d.each(r,function(w,v){if(w.indexOf(f)!==0||w==="lazylouId"){return}p=n(w);s.attr("data-"+p,null).removeData(p)})}if(q.options.src!==""&&q.options.src!==null){if(q.options.autoStart){b(q)}}delete s;delete q.metadata;k++;if(q.options.verbose){console.log(f+".js | ID="+q.options._cssSelector+" | Element initialization is complete.")}q.options.onInitialized();j(q,"Initialized")}function a(p,w){var v=null;switch(typeof(p)){case"undefined":return null;case"string":v=d(p);if(!v.length){return null}break;case"object":if(!p.length){if(d(p).length===0){return null}else{v=d(p)}}else{v=p}break}if(typeof(w)==="undefined"||w===""){w="$#."}else{if(w==="*"){w="$#.[]"}}var x="";if(w.indexOf("$")!==-1){x+=v.prop("tagName").toLowerCase()}if(w.indexOf("#")!==-1&&typeof(v.attr("id"))!=="undefined"){x+="#"+v.attr("id")}if(w.indexOf(".")!==-1){var s=v.attr("class");if(typeof(s)!=="undefined"){s=s.split(" ");for(var q=0;q<s.length;q++){x+=(s[q]!==""?"."+s[q]:"")}}}var y=w.indexOf("[");var r=w.indexOf("]");if(y!==-1&&r!==-1){if(r-y===1){d.each(v[0].attributes,function(A,B){if(B.name==="id"||B.name==="class"){return}x+="["+B.name+"='"+B.value+"']"})}else{var z=w.substring(y+1,r).split(",");var u=z.length;for(var t=0;t<u;t++){if(z[t].substring(0,1)==="!"){return v.attr(z[t].substring(1))}if(typeof(v.attr(z[t]))==="undefined"){continue}x+="["+z[t]+"='"+v.attr(z[t])+"']"}}}return x}function n(s){var r=s.length;var p="";for(var q=0;q<r;q++){if(s[q]==="-"){p+=s[++q].toUpperCase()}else{if(s[q].toUpperCase()===s[q]){p+="-"+s[q].toLowerCase()}else{p+=s[q]}}}return p}function b(p){d.lazylouLoadImage(p.options.src).done(function(q){o(p,q);p.options.onFinished.call();j(p,"ImageLoaded")})}function o(u,t){u.options.imageDimension={width:t.width,height:t.height};var r=l[u.options.name];if(typeof(r)==="undefined"){r=new Array();r[0]=u.options._id}var s=r.length;var v=null;for(var q=0;q<s;q++){v=d("[data-lazylou-id="+r[q]+"]").data("lazylou");v.options.src=t.src;v.options.imageDimension={width:t.width,height:t.height};d("[data-lazylou-id="+r[q]+"]").css("background-position",d.fn[f].calculateBackgroundPosition(v,"px")).css("background-image","url('"+t.src+"')");var p=(v.options._imageHorizontalSpriteCount*100);var w=(v.options._imageVerticalSpriteCount*100);d("[data-lazylou-id="+r[q]+"]").css("background-size",(p===0?"auto":p+"%")+" "+(w===0?"auto":w+"%"))}}function h(w,s){var u="";if(w!==null&&typeof(w)==="object"){u=w.options.spriteIndex.toString()}else{if(typeof(s)==="undefined"){console.log(f+".js | Error | ID="+w.options._cssSelector+" | Can NOT translate the sprite index.");return 0}u=s}var t=u.length;var q="";for(var r=0;r<t;r++){if(47<u.charCodeAt(r)&&u.charCodeAt(r)<58){q+=u[r];continue}switch(u[r]){case"%":switch(u[++r]){case"C":q+=k;break;case"I":q+=w.options._id;break;case"i":q+=w.options._siblingID;break}break;case"[":var p="";var v=u.indexOf("]");if(v===-1){console.log(f+".js | Error | ID="+w.options._cssSelector+" | Element's spriteIndex property is not properly assigned. Syntax error found. Calculated index will be return.");return q}p=u.substring(r+1,v-r).replace(/\s+/g,"").split(",");return h(null,p[w.options._siblingID])}}return parseInt(q,10)}function j(s,p,t){var q=d.fn[f]._addons.length;if(typeof(p)==="undefined"||q===0){return}for(var r=0;r<q;r++){d.fn[f]._addons[r].receiveCallback(s,p,t)}}d.fn[f]=function(t){if(!d.fn[f].loadingImageLoaded){d.lazylouLoadImage("img/loading.gif").done(function(u){d.fn[f].loadingImageLoaded=true})}var p=this;var q=p.length;for(var r=0;r<q;r++){d(p[r]).css("background-repeat","no-repeat").css("background-position","center center").css("background-image",'url("img/loading.gif")');if(q>1){var s={_siblingID:r};t=d.extend(t,s)}if(!d.data(p[r],f)){d.data(p[r],f,new m(p[r],t))}}return p[0]};d.fn[f].PLUGIN_NAME="lazylou";d.fn[f].loadingImageLoaded=false;d.fn[f].defaults={verbose:true,autoAdjustElementSize:true,autoAdjustSpriteSize:true,name:null,src:null,spriteDimension:{width:-1,height:-1},spriteIndex:-1,autoStart:true,cleanUp:true,_id:-1,_siblingID:0,_imageDimension:{width:-1,height:-1},_imageVerticalSpriteCount:-1,_imageHorizontalSpriteCount:-1,_spriteVerticalIndex:-1,_spriteHorizontalIndex:-1,_cssSelector:null,onInitialized:function(){},onFinished:function(){}};d.fn[f]._addons=[];d.fn[f].calculateBackgroundPosition=function(u,q,t){if(typeof(q)==="undefined"){q=null}if(u.options.src===null){console.log(f+".js | Warning | ID="+u.options._cssSelector+" | Terminating calculation, because of image has NOT been loaded yet.");return(q===null?{x:0,y:0}:"0"+q+" 0"+q)}if(typeof(t)==="undefined"){t=false}if(u.options.spriteDimension.width===-1||u.options.spriteDimension.height===-1){if(u.options.name!==null&&typeof(l[u.options.name])!=="undefined"){u.options.spriteDimension=d("[data-lazylou-id="+l[u.options.name][0]+"]").data("lazylou").options.spriteDimension}else{if(u.options.spriteIndex!==0){if(!u.options.autoAdjustSpriteSize){console.log(f+".js | Error | ID="+u.options._cssSelector+' | Background position can NOT be calculate due to lack of sprite dimension information. "0x0" will be returned from calculateBackgroundPosition().')}else{u.options.spriteDimension={width:u.element.offsetWidth,height:u.element.offsetHeight}}}}if(u.options.spriteDimension.width===-1||u.options.spriteDimension.height===-1){return(q===null?{x:0,y:0}:"0"+q+" 0"+q)}}if(d(u.element).width()===0||d(u.element).height()===0){if(!u.options.autoAdjustElementSize||u.options.spriteDimension.width===-1||u.options.spriteDimension.height===-1){console.log(f+".js | Error | ID="+u.options._cssSelector+' | Element\'s dimension and spriteDimension property can NOT be undefined at the sametime to calculate background position. Terminating function by returning "null"');return null}d(u.element).css("width",u.options.spriteDimension.width+"px");d(u.element).css("height",u.options.spriteDimension.height+"px")}else{var w=((d(u.element).width()/d(u.element).height())/(u.options.spriteDimension.width/u.options.spriteDimension.height));if(w!==1){console.log(f+".js | Error | ID="+u.options._cssSelector+" | Viewport's aspect ratio doesn't meet the sprite's aspect ratio. This occured because of poor responsive design.");return null}}var s=(d(u.element).width()/u.options.spriteDimension.width);var v=d.fn[f].gatherDimensionalIndexes(u,t);var r=v.horizontal*u.options.spriteDimension.width*s;var p=v.vertical*u.options.spriteDimension.height*s;if(u.options.verbose){console.log(f+".js | ID="+u.options._cssSelector+" | Background position re-calculated as "+r+"x"+p+".")}r=(r*-1);p=(p*-1);return(q===null?{x:r,y:p}:r+q+" "+p+q)};d.fn[f].gatherDimensionalIndexes2=function(u,r){if(u.options.verbose){console.log(f+".js | ID="+u.options._cssSelector+" | Dimensional indexes re-calculating...")}if(typeof(r)==="undefined"){r=false}if(!r){if(u.options._spriteHorizontalIndex>-1&&u.options._spriteVerticalIndex>-1){return{horizontal:u.options._spriteHorizontalIndex,vertical:u.options._spriteVerticalIndex}}}var v=u.options.imageDimension;if(v===c||v.width===-1||v.height===-1){console.log(f+".js | Warning | ID="+u.options._cssSelector+" | Due to image has NOT been loaded yet, image dimension can NOT used to gather indexes. Exiting from gatherDimensionalIndexes().");return{horizontal:0,vertical:0}}var p=u.options.spriteDimension;var q=u.options.viewportDimension;if(p.width===-1||p.height===-1){console.log(f+".js | Error | ID="+u.options._cssSelector+" | Sprite dimensions must be set in order to use spriteIndex property.");return{horizontal:0,vertical:0}}if(u.options._imageVerticalSpriteCount===-1||u.options._imageHorizontalSpriteCount===-1){u.options._imageHorizontalSpriteCount=(v.width/p.width);u.options._imageVerticalSpriteCount=(v.height/p.height)}var t=u.options._imageHorizontalSpriteCount*u.options._imageVerticalSpriteCount;var s=parseInt(u.options.spriteIndex,10);if(s===0){u.options._spriteHorizontalIndex=0;u.options._spriteVerticalIndex=0;return{horizontal:u.options._spriteHorizontalIndex,vertical:u.options._spriteVerticalIndex}}else{if(s>t){console.log(f+".js | Warning | ID="+u.options._cssSelector+" | Sprite index is greater that sprite(s) count. Sprite index will set to 0.");s=0;u.options._spriteHorizontalIndex=0;u.options._spriteVerticalIndex=0;return{horizontal:u.options._spriteHorizontalIndex,vertical:u.options._spriteVerticalIndex}}else{if(u.options._imageHorizontalSpriteCount>1){if(s>u.options._imageHorizontalSpriteCount){}else{}}else{if(u.options._imageVerticalSpriteCount>1){u.options._spriteHorizontalIndex=0;u.options._spriteVerticalIndex=parseInt(s,10)}else{console.log(f+".js | Warning | ID="+u.options._cssSelector+" | There is one sprite exist but spriteIndex is greater than 0.");return{horizontal:0,vertical:0}}}}}return{horizontal:u.options._spriteHorizontalIndex,vertical:u.options._spriteVerticalIndex}};d.fn[f].gatherDimensionalIndexes=function(u,r){if(typeof(r)==="undefined"){r=false}if(!r){if(u.options._spriteHorizontalIndex>-1&&u.options._spriteVerticalIndex>-1){return{horizontal:u.options._spriteHorizontalIndex,vertical:u.options._spriteVerticalIndex}}}var v=u.options.imageDimension;if(v===c||v.width===-1||v.height===-1){console.log(f+".js | Warning | ID="+u.options._cssSelector+" | Due to image has NOT been loaded yet, image dimension can NOT used to gather indexes. Exiting from gatherDimensionalIndexes().");return{horizontal:0,vertical:0}}var p=u.options.spriteDimension;var q={width:u.element.offsetWidth,height:u.element.offsetHeight};if(p.width===-1||p.height===-1){console.log(f+".js | Error | ID="+u.options._cssSelector+" | Sprite dimensions must be set in order to use spriteIndex property.");return{horizontal:0,vertical:0}}if(u.options._imageVerticalSpriteCount===-1||u.options._imageHorizontalSpriteCount===-1){u.options._imageHorizontalSpriteCount=(v.width/p.width);u.options._imageVerticalSpriteCount=(v.height/p.height)}var t=u.options._imageHorizontalSpriteCount*u.options._imageVerticalSpriteCount;var s=parseInt(u.options.spriteIndex,10);if(s===NaN){console.log(f+".js | Error | ID="+u.options._cssSelector+" | c_SpriteIndex can NOT be equal or greater than sprites count.");return{horizontal:0,vertical:0}}if(s>=t){console.log(f+".js | Error | ID="+u.options._cssSelector+" | c_SpriteIndex can NOT be equal or greater than sprites count.");return{horizontal:0,vertical:0}}u.options._spriteVerticalIndex=parseInt(s/u.options._imageHorizontalSpriteCount,10);u.options._spriteHorizontalIndex=(s-(u.options._spriteVerticalIndex*u.options._imageHorizontalSpriteCount));if(u.options.verbose){console.log(f+".js | ID="+u.options._cssSelector+" | Dimensional index is "+u.options._spriteHorizontalIndex+"x"+u.options._spriteVerticalIndex)}return{horizontal:u.options._spriteHorizontalIndex,vertical:u.options._spriteVerticalIndex}}})(jQuery,window,document);var m_LazylouResizeTimeout;function _lazylouResizeEnd(){if($.fn.lazylou.defaults.verbose){console.log("lazylou.js | Resize end.")}var a=null;$("[data-lazylou-id]").each(function(b,c){a=$(c);if(a.data("lazylou").options.spriteIndex===0){return}$(a).css("background-position",$.fn.lazylou.calculateBackgroundPosition(a.data("lazylou"),"px",true))})}$(window).resize(function(){clearTimeout(m_LazylouResizeTimeout);m_LazylouResizeTimeout=setTimeout(function(){_lazylouResizeEnd()},200)});